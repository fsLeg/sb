# Maintainer: Vladislav 'fsLeg' Borisov <fsleg at t-rg dot ws>

PRGNAM="amneziawg-tools"
VERSION="${VERSION:-1.0.20250903}"
BUILD="${BUILD:-1}"
DESCRIPTION="Tools for configuring AmneziaWG"
HOMEPAGE="https://github.com/amnezia-vpn/amneziawg-tools"
DOWNLOAD="https://github.com/amnezia-vpn/amneziawg-tools/archive/v${VERSION}/${PRGNAM}-${VERSION}.tar.gz"
SHA256SUM="d729a6f54aafcd55b2cbb7324f09ca8f0d2536772970652bf822a271d0c907d7"

unpack () {
  tar xvf $CWD/$PRGNAM-$VERSION.tar.gz
}

build () {
  make -C src

  PREFIX=$_PREFIX \
  LIBDIR=$_PREFIX/lib${LIBDIRSUFFIX} \
  MANDIR=$_PREFIX/man \
  WITH_BASHCOMPLETION=yes \
  WITH_WGQUICK=yes \
  WITH_SYSTEMDUNITS=no \
  DESTDIR=$PKG \
  make -C src install

  mkdir -p $PKG/$_PREFIX/doc/$PRGNAM-$VERSION
  cp -aR \
    COPYING README.md contrib/ \
    $PKG/$_PREFIX/doc/$PRGNAM-$VERSION/
}
